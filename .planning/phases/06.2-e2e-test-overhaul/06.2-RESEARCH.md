# Phase 6.2: E2E Test Overhaul - Research

**Researched:** 2026-01-23
**Domain:** Playwright E2E testing for React application with framer-motion
**Confidence:** HIGH

## Summary

Phase 6.2 requires auditing and updating existing Playwright E2E tests to match the architectural changes from Phase 6.1, which replaced the daily cycle system with descent clock, added conviction/journey systems, reworked dialogue flow, and deleted several components (ApproachChips, ConflictTrigger, CycleView, DicePool, CycleSummary).

The project uses Playwright 1.57.0 with a step-based helper pattern (not full Page Object Model). Tests are organized by feature domain (character, conflict, descent-clock, free-roam, investigation, town-generation) with reusable step functions in `e2e/steps/`. Current setup uses testId selectors, API mocking for dialogue, and timeout-based animation handling.

Phase 6.1 introduced 6 major systems requiring E2E coverage: (1) 6-step character creation wizard with conviction picker, (2) dialogue rework with player voice options and "Press the Matter" conflict entry, (3) descent clock advancement and threshold events, (4) journey flow across multiple towns with conviction reflection, (5) trust mechanics including ripple effects and trust breaking, and (6) edge case fixes from commit f2e30c7 covering conviction testing, dialogue streaming errors, and journey phase transitions.

**Primary recommendation:** Audit existing tests for broken references to deleted components, add comprehensive coverage for new Phase 6.1 systems using existing step-based pattern, focus on user journey flows rather than implementation details, and ensure regression coverage for edge cases fixed in f2e30c7.

## Standard Stack

The established libraries/tools for E2E testing in this project:

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| @playwright/test | 1.57.0 | E2E test framework | Industry standard for modern E2E testing, auto-wait, parallel execution, cross-browser support |
| playwright.config.ts | - | Test configuration | Centralized config for baseURL, timeout, retry, webServer, reporters |

### Supporting
| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| framer-motion | 12.28.1 | Animation library | Animations in UI — tests must handle motion delays |
| vitest | 4.0.18 | Unit test runner | Not for E2E — use Playwright exclusively for E2E |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| Playwright | Cypress | Playwright has better TypeScript support, faster execution, multi-browser by default |
| Step helpers | Full POM | Step helpers are lighter-weight for small-to-medium projects, easier to read |

**Installation:**
```bash
npm install --save-dev @playwright/test@^1.57.0
```

## Architecture Patterns

### Recommended Project Structure
```
e2e/
├── fixtures/              # Test fixtures and test data
│   ├── base.ts           # Extended test/expect with custom fixtures
│   └── dialogue-recordings.json  # Mocked dialogue responses
├── steps/                # Reusable step helper functions
│   ├── character.steps.ts
│   ├── conflict.steps.ts
│   ├── free-roam.steps.ts
│   ├── investigation.steps.ts
│   └── townGeneration.steps.ts
├── character.spec.ts     # Character system tests
├── conflict.spec.ts      # Conflict system tests
├── descent-clock.spec.ts # Descent clock tests
├── free-roam.spec.ts     # Free roam gameplay tests
├── investigation.spec.ts # Investigation/dialogue tests
└── town-generation.spec.ts # Town generation tests
```

### Pattern 1: Step-Based Helper Functions
**What:** Extract common operations into reusable step functions organized by domain
**When to use:** When tests share common workflows (character creation, navigation, dialogue)
**Example:**
```typescript
// Source: /Users/jedwards/workspace/JobPrep/GSDPlayground/e2e/steps/character.steps.ts
export async function setupCharacterForTest(page: Page, name: string = 'Test Dog') {
  await openCharacterCreation(page);
  await enterCharacterName(page, name);
  await selectBackground(page, 'well-rounded');
  await allocateStatDice(page, 'acuity', 3);
  await allocateStatDice(page, 'body', 3);
  await allocateStatDice(page, 'heart', 2);
  await allocateStatDice(page, 'will', 2);
  const allocateNext = page.getByTestId('creation-allocate-next');
  await expect(allocateNext).toBeEnabled({ timeout: 2000 });
  await allocateNext.click();
  await selectBelongings(page);
  await selectInitiationApproach(page);
  await confirmCreation(page);
  await skipArrivalOverlay(page);
}
```

### Pattern 2: API Route Mocking for Deterministic Dialogue
**What:** Intercept `/api/dialogue` route and return recorded responses
**When to use:** Testing investigation/dialogue flows without live LLM calls
**Example:**
```typescript
// Source: /Users/jedwards/workspace/JobPrep/GSDPlayground/e2e/investigation.spec.ts
test.beforeEach(async ({ page }) => {
  await page.route('**/api/dialogue', async (route) => {
    const request = route.request();
    let body: { npcId?: string; topic?: string } = {};
    try {
      const postData = request.postData();
      if (postData) body = JSON.parse(postData);
    } catch {}

    const npcId = body.npcId ?? '';
    const topic = body.topic ?? '';
    const response = findRecording(npcId, topic);

    if (response) {
      await route.fulfill({
        status: 200,
        contentType: 'text/plain; charset=utf-8',
        body: response,
      });
    }
  });
});
```

### Pattern 3: Animation Handling with Timeouts and Force Clicks
**What:** Wait for framer-motion animations to settle before assertions
**When to use:** Testing UI with motion transitions (town arrival, dialogue overlays)
**Example:**
```typescript
// Source: /Users/jedwards/workspace/JobPrep/GSDPlayground/e2e/steps/character.steps.ts
export async function skipArrivalOverlay(page: Page) {
  const arrivalOverlay = page.getByTestId('town-arrival');
  if (!await arrivalOverlay.isVisible({ timeout: 2000 }).catch(() => false)) {
    return;
  }

  for (let i = 0; i < 6; i++) {
    await page.waitForTimeout(700); // Wait for framer-motion animation to settle
    if (!await arrivalOverlay.isVisible({ timeout: 500 }).catch(() => false)) {
      return;
    }
    const continueBtn = page.getByTestId('arrival-continue');
    if (await continueBtn.isVisible({ timeout: 500 }).catch(() => false)) {
      await continueBtn.click({ force: true }); // Force through animations
    }
  }
}
```

### Pattern 4: Test Organization by Feature Domain
**What:** Group tests by business domain (character, conflict, investigation) not by component
**When to use:** Always — organize by user journeys, not implementation structure
**Example:**
```typescript
// Source: Existing test organization
test.describe('Character System', () => {
  // Character creation, traits, stats, inventory
});

test.describe('Conflict System', () => {
  // Raise/see, escalation, fallout
});

test.describe('Investigation System', () => {
  // Dialogue, discovery, mental map
});
```

### Anti-Patterns to Avoid
- **Hard-coded delays:** Don't use `waitForTimeout(5000)` when Playwright has `waitForSelector` or `toBeVisible({ timeout })`
- **Testing implementation details:** Don't test internal state or component props — test user-visible behavior
- **Over-mocking:** Don't mock the entire app — only mock external dependencies (LLM API, not game logic)
- **Brittle selectors:** Don't use CSS class names or element hierarchy — use `data-testid` attributes
- **Flaky assertions:** Don't assert on animation mid-state — wait for animation completion

## Don't Hand-Roll

Problems that look simple but have existing solutions:

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Test isolation | Manual cleanup between tests | Playwright's auto-isolation | Each test gets fresh context, storage, cookies automatically |
| Animation waiting | Manual setTimeout loops | Playwright auto-wait + strategic timeouts | Auto-wait handles most cases, explicit timeouts only for complex animations |
| Selector strategies | XPath or CSS hierarchy | `getByRole`, `getByTestId`, `getByText` | Playwright's built-in selectors are more resilient to UI changes |
| API mocking | Custom fetch wrapper | `page.route()` | Playwright's route interception handles streaming, headers, timing |
| Parallel execution | Custom test runner | Playwright's built-in parallelization | Playwright runs tests in parallel by default with proper isolation |
| Visual regression | Screenshot comparison scripts | Playwright's `toHaveScreenshot()` | Built-in diffing, automatic retry, cross-platform support |
| Debugging | Console.log in tests | `--debug`, `--ui`, trace viewer | Playwright's debugging tools show timeline, network, DOM snapshots |

**Key insight:** Playwright has solved most E2E testing problems — prefer built-in features over custom solutions. Custom solutions create maintenance burden and miss edge cases.

## Common Pitfalls

### Pitfall 1: Deleted Component References
**What goes wrong:** Tests reference components/testIds that were deleted in Phase 6.1 refactor
**Why it happens:** Phase 6.1 deleted ApproachChips, ConflictTrigger, CycleView, DicePool, CycleSummary, ActionCard, ActionList, FatigueClock
**How to avoid:** Audit all test files for references to deleted components, replace with new component equivalents
**Warning signs:** Test failures with "selector not found" for deleted testIds

**Deleted in Phase 6.1:**
- `ApproachChips` → replaced with approach selection overlay before conflict
- `ConflictTrigger` → replaced with "Press the Matter" button in dialogue
- `CycleView`, `DicePool`, `DieComponent`, `CycleSummary` → daily cycle removed entirely
- `ActionCard`, `ActionList` → replaced with ActionMenu for descent clock actions
- `FatigueClock` → removed with daily cycle

### Pitfall 2: Animation Timing Races
**What goes wrong:** Tests click before framer-motion animations complete, causing missed clicks or wrong state
**Why it happens:** Framer-motion animations (town arrival, dialogue transitions) have duration but no DOM indicators
**How to avoid:** Use `waitForTimeout(700)` for animation settle + force clicks, or check for disabled states
**Warning signs:** Intermittent test failures where click actions don't register

**Example from existing code:**
```typescript
// GOOD: Wait for animation, then force click
await page.waitForTimeout(700);
await continueBtn.click({ force: true });

// BAD: Click immediately
await continueBtn.click(); // May click mid-animation, no effect
```

### Pitfall 3: Streaming API Response Timing
**What goes wrong:** Tests assert on dialogue content before streaming completes
**Why it happens:** `/api/dialogue` returns streaming text, not immediate JSON
**How to avoid:** Mock route with complete response body, or wait for `dialogue-continue` button to appear
**Warning signs:** Tests fail with "expected text not found" when dialogue is mid-stream

**Example from existing code:**
```typescript
// Route returns complete body immediately in tests
await route.fulfill({
  status: 200,
  contentType: 'text/plain; charset=utf-8',
  body: response, // Complete response, not streamed
});

// Wait for response completion indicator
await expect(page.getByTestId('dialogue-continue')).toBeVisible({ timeout: 5000 });
```

### Pitfall 4: Conviction Reflection State Transitions
**What goes wrong:** Journey phase doesn't advance correctly after conviction reflection
**Why it happens:** Edge case fixed in f2e30c7 — ConvictionReflection must read from `completedTowns` not `pendingTests`
**How to avoid:** Test multi-town journey flows end-to-end, verify phase transitions (REFLECTION → RIDING_ON → next TOWN_ACTIVE)
**Warning signs:** Tests hang at reflection screen, journey doesn't advance

### Pitfall 5: Trust Mechanics Edge Cases
**What goes wrong:** Trust breaking mechanics don't trigger correctly in edge cases
**Why it happens:** Trust ripple and trust breaking require specific sequences (betrayal while below threshold)
**How to avoid:** Test trust changes across connected NPCs, test trust cap enforcement after breaking
**Warning signs:** Trust values don't update as expected, trust cap not enforced

### Pitfall 6: Test Data Dependencies
**What goes wrong:** Tests fail because they depend on specific NPC/location availability
**Why it happens:** Generated towns have randomized NPCs and locations
**How to avoid:** Use hand-crafted town (bridal-falls) for deterministic tests, or use step helpers that find ANY available NPC
**Warning signs:** Tests pass locally but fail in CI due to different random seeds

**Example from existing code:**
```typescript
// GOOD: Use hand-crafted town with known NPCs
await page.getByTestId('select-town-bridal-falls').click();

// RISKY: Generated town may not have expected NPC
await page.getByTestId('select-town-hollow-creek').click();
```

### Pitfall 7: Character Creation Wizard Step Order
**What goes wrong:** Tests advance steps in wrong order or miss new conviction picker step
**Why it happens:** Phase 6.1 expanded creation from point-buy to 6-step wizard, added conviction picker as final step
**How to avoid:** Update creation flow tests to cover all 6 steps: name → background → allocate → belongings → initiation → convictions
**Warning signs:** Tests fail at "confirm creation" because wizard incomplete

## Code Examples

Verified patterns from official sources and existing codebase:

### Testing 6-Step Character Creation Wizard
```typescript
// Source: Phase 6.1 SUMMARY.md + existing character.steps.ts
test('Scenario: Complete character creation with convictions', async ({ page }) => {
  await page.goto('/');
  await page.getByTestId('select-town-bridal-falls').click();

  // Step 1: Name
  await page.getByTestId('creation-name-input').fill('Brother Ezekiel');
  await page.locator('button:has-text("Continue")').click();

  // Step 2: Background
  await page.getByTestId('creation-background-well-rounded').click();

  // Step 3: Allocate stats (auto-advances from step 2)
  await allocateStatDice(page, 'acuity', 3);
  await allocateStatDice(page, 'body', 3);
  await allocateStatDice(page, 'heart', 2);
  await allocateStatDice(page, 'will', 2);
  await page.getByTestId('creation-allocate-next').click();

  // Step 4: Belongings
  await selectBelongings(page); // Selects first 2 items, clicks Next

  // Step 5: Initiation
  await page.locator('[data-testid^="creation-approach-"]').first().click();

  // Step 6: Convictions (NEW in Phase 6.1)
  await page.getByTestId('conviction-seed-mercy-1').click();
  await page.getByTestId('conviction-seed-justice-2').click();
  await page.getByTestId('conviction-seed-duty-1').click();
  await page.getByTestId('conviction-confirm').click();

  // Confirm creation
  await page.getByTestId('creation-confirm').click();

  // Skip town arrival
  await skipArrivalOverlay(page);

  // Verify character created
  await expect(page.getByTestId('character-info')).toContainText('Brother Ezekiel');
});
```

### Testing Dialogue Rework with Player Voice
```typescript
// Source: Phase 6.1 SUMMARY.md + investigation.spec.ts
test('Scenario: Dialogue with player voice options', async ({ page }) => {
  // Mock dialogue API
  await page.route('**/api/dialogue', async (route) => {
    await route.fulfill({
      status: 200,
      contentType: 'text/plain; charset=utf-8',
      body: '[Player]: Tell me about this place.\n[NPC]: This town has troubles, Brother.',
    });
  });

  await setupCharacterForTest(page);

  // Navigate to NPC location
  await page.locator('[data-testid="map-node-general-store"]').dispatchEvent('click');
  await page.waitForTimeout(500);

  // Start conversation
  await page.getByTestId('npc-button-sister-martha').click();
  await expect(page.getByTestId('dialogue-view')).toBeVisible();

  // Select topic (triggers player voice options)
  await page.getByTestId('topic-chip-the-town').click();

  // Player voice options appear (NEW in Phase 6.1)
  // DialogueOptionCard with tone, stat association, risk indicator
  const options = page.locator('[data-testid^="dialogue-option-"]');
  await expect(options.first()).toBeVisible({ timeout: 3000 });

  // Select first voice option
  await options.first().click();

  // Wait for response
  await expect(page.getByTestId('dialogue-continue')).toBeVisible({ timeout: 5000 });
});
```

### Testing "Press the Matter" Conflict Entry
```typescript
// Source: investigation.spec.ts + Phase 6.1 SUMMARY.md
test('Scenario: Press the Matter triggers conflict', async ({ page }) => {
  // Mock dialogue API to return deflection
  await page.route('**/api/dialogue', async (route) => {
    await route.fulfill({
      status: 200,
      contentType: 'text/plain; charset=utf-8',
      body: '[Player]: Tell me about the Sheriff.\n[NPC]: I... I cannot speak of that, Brother.\n[DEFLECTED]',
    });
  });

  await setupCharacterForTest(page);

  // Navigate to sheriff's office
  await page.locator('[data-testid="map-node-sheriffs-office"]').dispatchEvent('click');
  await page.waitForTimeout(500);

  // Start conversation
  await page.getByTestId('npc-button-sheriff-jacob').click();

  // Select trust-gated topic (triggers deflection)
  await page.getByTestId('topic-chip-the-town').click();
  await page.waitForTimeout(500); // Wait for response to stream

  // "Press the Matter" button appears (NEW in Phase 6.1)
  const pressButton = page.getByTestId('press-the-matter');
  await expect(pressButton).toBeVisible({ timeout: 5000 });
  await pressButton.click();

  // Approach selection overlay appears (NEW in Phase 6.1)
  const approachOverlay = page.getByTestId('approach-selection-overlay');
  await expect(approachOverlay).toBeVisible({ timeout: 3000 });

  // Select approach to start conflict
  await page.getByTestId('select-approach-body').click();

  // Conflict view should appear
  await expect(page.getByTestId('conflict-view')).toBeVisible({ timeout: 5000 });
});
```

### Testing Journey Flow and Conviction Reflection
```typescript
// Source: Phase 6.1 SUMMARY.md + journey types
test('Scenario: Complete town and reflect on convictions', async ({ page }) => {
  await setupCharacterForTest(page);

  // ... play through town, trigger conviction tests ...

  // Complete town via judgment
  await page.getByTestId('open-judgment-panel').click();
  await page.getByTestId('judgment-resolve-sin').click();
  await page.getByTestId('judgment-confirm').click();

  // ConvictionReflection phase begins (NEW in Phase 6.1)
  await expect(page.getByText('Conviction 1 of')).toBeVisible({ timeout: 5000 });

  // Verify conviction text appears
  const convictionText = page.locator('text="I will protect the innocent"');
  await expect(convictionText).toBeVisible();

  // Choose reflection: reinforce, doubt, or transform
  await page.locator('button:has-text("Reinforce")').click();

  // If more convictions were tested, they appear sequentially
  // Otherwise, advance to RIDING_ON phase

  // JourneyProgress phase (NEW in Phase 6.1)
  await expect(page.getByText('The Road Ahead')).toBeVisible({ timeout: 5000 });
  await expect(page.getByText('Town 2 of')).toBeVisible();

  // Continue to next town
  await page.locator('button:has-text("Continue to Next Town")').click();

  // Town selection appears for next town
  await expect(page.getByTestId('town-selection')).toBeVisible({ timeout: 5000 });
});
```

### Testing Descent Clock Advancement
```typescript
// Source: descent-clock.spec.ts
test('Scenario: Timed action advances descent clock', async ({ page }) => {
  await setupCharacterForTest(page);

  // Navigate to location with timed action
  await page.locator('[data-testid="map-node-well"]').dispatchEvent('click');
  await page.waitForTimeout(500);

  // Check initial descent (0/8)
  await expect(page.locator('text=0/8')).toBeVisible();

  // Perform timed action
  await page.getByTestId('action-inspect-well').click();

  // Descent advances to 1/8
  await expect(page.locator('text=1/8')).toBeVisible();
});

test('Scenario: Descent threshold triggers event', async ({ page }) => {
  await setupCharacterForTest(page);

  // Advance descent to threshold (2) by performing multiple actions
  await navigateTo(page, 'well');
  await performTimedAction(page, 'action-inspect-well'); // +1 → 1/8

  await navigateTo(page, 'church');
  await performTimedAction(page, 'action-read-decree'); // +1 → 2/8

  // Event overlay appears at threshold
  const eventOverlay = page.getByTestId('dismiss-event');
  await expect(eventOverlay).toBeVisible({ timeout: 3000 });

  // Dismiss event
  await eventOverlay.click();
  await expect(eventOverlay).not.toBeVisible();
});
```

### Testing Trust Mechanics
```typescript
// Source: Phase 6.1 SUMMARY.md (trust ripple and trust breaking)
test('Scenario: Trust ripple affects connected NPCs', async ({ page }) => {
  await setupCharacterForTest(page);

  // Perform action that increases trust with NPC A
  // (Implementation depends on action system — placeholder for pattern)
  await performActionThatIncreasesTrust(page, 'sister-martha');

  // Verify trust increased with connected NPCs (trust ripple)
  await page.getByTestId('view-relationships').click();
  await expect(page.getByTestId('npc-trust-sister-martha')).toContainText('15'); // +5 from action
  await expect(page.getByTestId('npc-trust-connected-npc')).toContainText('12'); // +2 ripple
});

test('Scenario: Trust breaking caps trust at 10', async ({ page }) => {
  await setupCharacterForTest(page);

  // Reduce trust below threshold via betrayal action
  // (Implementation depends on action system — placeholder for pattern)
  await performBetrayalAction(page, 'sheriff-jacob');

  // Trust breaks, capped at 10
  await page.getByTestId('view-relationships').click();
  const trustValue = page.getByTestId('npc-trust-sheriff-jacob');
  await expect(trustValue).toContainText('10'); // Capped

  // Verify trust cannot increase above 10 even with positive actions
  await performActionThatIncreasesTrust(page, 'sheriff-jacob');
  await expect(trustValue).toContainText('10'); // Still capped
});
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Daily cycle (wake/allocate/resolve) | Descent clock with timed actions | Phase 6.1 (Jan 2026) | All cycle-related tests must be deleted or rewritten for descent clock |
| Approach selection in dialogue | Player voice options + "Press the Matter" | Phase 6.1 (Jan 2026) | Dialogue tests must use new flow: topic → voice → response → conflict entry |
| Point-buy character creation | 6-step wizard with convictions | Phase 6.1 (Jan 2026) | Character tests must cover all 6 steps including conviction picker |
| Single-town gameplay | Multi-town journey with persistence | Phase 6.1 (Jan 2026) | Tests must handle journey phases: TOWN_ACTIVE → REFLECTION → RIDING_ON |
| Hard-coded waits | Playwright auto-wait + strategic timeouts | Best practice 2026 | Use `toBeVisible({ timeout })` instead of `waitForTimeout` where possible |
| CSS selectors | testId + semantic selectors | Best practice 2026 | Prefer `getByTestId`, `getByRole`, `getByText` over CSS hierarchy |

**Deprecated/outdated:**
- **cycle-flow.spec.ts, cycle-resolve.spec.ts:** Deleted in Phase 6.1 — daily cycle no longer exists
- **ApproachChips, ConflictTrigger components:** Deleted in Phase 6.1 — replaced with approach overlay and "Press the Matter"
- **Hard-coded setTimeout(5000):** Anti-pattern — use Playwright's `{ timeout }` option instead

## Open Questions

Things that couldn't be fully resolved:

1. **Conviction Testing Triggers**
   - What we know: Conviction tests trigger on discovery, judgment, conflict_outcome, npc_revelation (from conviction.ts types)
   - What's unclear: Specific user actions that trigger each test type in E2E flow
   - Recommendation: Review `convictionTesting.ts` utility to understand trigger conditions, create targeted E2E scenarios for each

2. **Edge Case Details from f2e30c7**
   - What we know: Commit f2e30c7 fixed 8 edge cases covering STREAM_ERROR, exchange cap, duty testing, whitespace validation, phase transitions
   - What's unclear: Exact reproduction steps for each edge case to create regression tests
   - Recommendation: Review commit diff and test files to extract specific scenarios, document as regression test cases

3. **Animation Timing Consistency**
   - What we know: Framer-motion animations require `waitForTimeout(700)` + force clicks in some cases
   - What's unclear: Whether there's a more reliable approach than hard-coded timeouts
   - Recommendation: Investigate Playwright's `page.emulateMedia({ reducedMotion: 'reduce' })` for disabling animations in tests (2026 best practice)

4. **Trust Ripple Mechanics**
   - What we know: Trust changes with one NPC affect connected NPCs (trust ripple from Phase 6.1)
   - What's unclear: Magnitude of ripple effect and which NPCs are considered "connected"
   - Recommendation: Review `useNPCMemory.tsx` to understand ripple algorithm, create tests verifying specific ripple amounts

5. **Journey Completion Conditions**
   - What we know: Journey ends after 7 towns or when all convictions resolved
   - What's unclear: Specific UI flow for journey end vs. normal town completion
   - Recommendation: Test both end conditions separately, verify JourneyEnd component appears vs. JourneyProgress

## Sources

### Primary (HIGH confidence)
- Official Playwright Documentation: [Best Practices](https://playwright.dev/docs/best-practices)
- Official Playwright Documentation: [Fixtures](https://playwright.dev/docs/test-fixtures)
- Official Playwright Documentation: [Release Notes](https://playwright.dev/docs/release-notes)
- Project codebase: `/Users/jedwards/workspace/JobPrep/GSDPlayground/e2e/` (existing test suite)
- Project codebase: `/Users/jedwards/workspace/JobPrep/GSDPlayground/playwright.config.ts`
- Project codebase: `/Users/jedwards/workspace/JobPrep/GSDPlayground/.planning/phases/06.1-core-mechanics-overhaul/SUMMARY.md`
- Git commit history: f2e30c7, c8995b5, ba72019, d2e8df4 (Phase 6.1 changes)

### Secondary (MEDIUM confidence)
- [15 Best Practices for Playwright testing in 2026 | BrowserStack](https://www.browserstack.com/guide/playwright-best-practices)
- [Playwright 1.57 — The Must-Use Update for Web Test Automation in 2025 | Medium](https://medium.com/@szaranger/playwright-1-57-the-must-use-update-for-web-test-automation-in-2025-b194df6c9e03)
- [Component Testing with Playwright in 2026 | BrowserStack](https://www.browserstack.com/guide/component-testing-react-playwright)
- [Improve Playwright Tests with POMs and Fixtures](https://www.checklyhq.com/blog/page-object-models-and-fixtures-with-playwright/)

### Tertiary (LOW confidence)
- [End-to-End Testing: 2026 Guide for E2E Testing](https://www.leapwork.com/blog/end-to-end-testing) - General E2E guidance
- [E2E Test Coverage: Ensure You're Testing the Right Scenarios](https://bugbug.io/blog/software-testing/e2e-test-coverage/) - Coverage strategy
- [Automating Animation Testing with Playwright](https://www.thegreenreport.blog/articles/automating-animation-testing-with-playwright-a-practical-guide/automating-animation-testing-with-playwright-a-practical-guide.html) - Animation handling

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - Playwright 1.57.0 confirmed in package.json, config file reviewed
- Architecture: HIGH - Existing test structure analyzed, step helpers pattern verified
- Pitfalls: HIGH - Deleted components identified from git history, animation issues observed in existing tests
- Code examples: HIGH - All examples sourced from existing codebase or Phase 6.1 SUMMARY.md
- Journey/conviction flows: MEDIUM - Types and components reviewed, but full E2E flow needs validation
- Trust mechanics: MEDIUM - Hooks reviewed, but specific ripple amounts and edge cases need testing
- Edge cases from f2e30c7: LOW - Commit message reviewed, but detailed reproduction steps need investigation

**Research date:** 2026-01-23
**Valid until:** 2026-02-23 (30 days - Playwright is stable, but project evolving rapidly)
