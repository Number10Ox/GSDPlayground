---
phase: 02-cycle-system
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/game.ts
  - src/components/Clocks/Clock.tsx
  - src/components/Clocks/ClockList.tsx
  - src/components/Clocks/index.ts
autonomous: true

must_haves:
  truths:
    - "Player can see progress clocks with filled/empty segments"
    - "Clocks visually indicate their type (danger, progress, opportunity)"
    - "Clocks display their label"
  artifacts:
    - path: "src/types/game.ts"
      provides: "Clock and ClockType type definitions"
      contains: "ClockType.*danger.*progress.*opportunity"
    - path: "src/components/Clocks/Clock.tsx"
      provides: "SVG segmented clock visualization"
      min_lines: 30
    - path: "src/components/Clocks/ClockList.tsx"
      provides: "Container for multiple clocks"
      min_lines: 15
  key_links:
    - from: "src/components/Clocks/Clock.tsx"
      to: "src/types/game.ts"
      via: "Clock type import"
      pattern: "import.*Clock.*from.*types/game"
---

<objective>
Build the clock visualization system for tracking threats, opportunities, and progress.

Purpose: Clocks create time pressure and visual storytelling - a filling danger clock tells the player they can't investigate forever. This is essential for DitV's "you must eventually act" tension.
Output: Segmented SVG clock components that can display 4, 6, or 8 segment clocks in different states.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-cycle-system/02-CONTEXT.md
@.planning/phases/02-cycle-system/02-RESEARCH.md

# Existing codebase
@src/types/game.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add clock type definitions</name>
  <files>src/types/game.ts</files>
  <action>
    Add clock-related types to src/types/game.ts (append, don't replace existing):

    ```typescript
    export type ClockType = 'danger' | 'progress' | 'opportunity';

    export interface Clock {
      id: string;
      label: string;
      segments: 4 | 6 | 8;
      filled: number;       // How many segments filled (0 to segments)
      type: ClockType;
      autoAdvance: boolean; // Whether it advances each cycle automatically
    }
    ```

    Note: If Plan 01 already added some types, merge carefully. Only add what's missing.
  </action>
  <verify>TypeScript compiles: `npm run build` passes</verify>
  <done>Clock and ClockType types exported from game.ts</done>
</task>

<task type="auto">
  <name>Task 2: Create SVG clock component</name>
  <files>src/components/Clocks/Clock.tsx</files>
  <action>
    Create Clock component using SVG stroke-dasharray for segmented circles:

    Props:
    - segments: 4 | 6 | 8
    - filled: number (0 to segments)
    - label: string
    - variant: 'danger' | 'progress' | 'opportunity' (defaults to 'progress')

    Implementation approach:
    1. SVG viewBox="0 0 100 100" for consistent sizing
    2. Circle radius ~40, centered at 50,50
    3. For each segment, render a circle arc using stroke-dasharray
    4. Calculate segment length: circumference / segments
    5. Gap between segments: ~4px visual gap
    6. Rotate -90deg to start segments at 12 o'clock position
    7. Filled segments use variant color, empty use gray-700

    Color scheme:
    - danger: red-500 filled, gray-700 empty
    - progress: blue-500 filled, gray-700 empty
    - opportunity: green-500 filled, gray-700 empty

    Display label below clock in text-xs text-gray-400.
    Component size: w-16 h-16 (via Tailwind class on svg).

    Add transition-colors duration-300 for smooth fill changes.
  </action>
  <verify>Visual check: Render Clock with segments=6, filled=3, confirm half the segments are colored</verify>
  <done>Clock renders segmented circle with correct filled/empty state and color by variant</done>
</task>

<task type="auto">
  <name>Task 3: Create ClockList container</name>
  <files>src/components/Clocks/ClockList.tsx, src/components/Clocks/index.ts</files>
  <action>
    Create ClockList component:

    Props:
    - clocks: Clock[]

    Layout:
    - Horizontal flex with gap-4
    - flex-wrap for overflow
    - Can be empty (renders nothing if no clocks)

    Renders Clock component for each clock in array, passing props from Clock interface.

    Create index.ts barrel export for Clock and ClockList.
  </action>
  <verify>
    1. TypeScript compiles: `npm run build`
    2. Visual: Render ClockList with 3 sample clocks (danger, progress, opportunity), confirm all display correctly
  </verify>
  <done>ClockList renders multiple clocks in horizontal layout</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Clock type exported from game.ts
3. Clock component renders segmented circles correctly
4. ClockList renders multiple clocks
5. Visual: Danger clocks are red, progress blue, opportunity green
6. Visual: Segments start at 12 o'clock position
</verification>

<success_criteria>
- Player sees visually distinct clocks indicating time pressure
- Clocks show correct number of segments (4, 6, or 8)
- Filled vs empty segments are clearly distinguishable
- Clock type is immediately recognizable by color
</success_criteria>

<output>
After completion, create `.planning/phases/02-cycle-system/02-02-SUMMARY.md`
</output>
